<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #6d6d6d; -webkit-text-stroke: #6d6d6d}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #6b0001; -webkit-text-stroke: #6b0001}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #fb0007; -webkit-text-stroke: #fb0007}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #0000ff; -webkit-text-stroke: #0000ff}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; -webkit-text-stroke: #000000}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #4d5055; -webkit-text-stroke: #4d5055}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; -webkit-text-stroke: #000000; min-height: 16.0px}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #18702b; -webkit-text-stroke: #18702b}
    span.s1 {font-kerning: none; background-color: #ecf1f7}
    span.s2 {font-kerning: none; color: #fb0007; background-color: #ecf1f7; -webkit-text-stroke: 0px #fb0007}
    span.s3 {font-kerning: none; color: #2a2a2a; background-color: #ecf1f7; -webkit-text-stroke: 0px #2a2a2a}
    span.s4 {font-kerning: none; color: #000000; background-color: #ecf1f7; -webkit-text-stroke: 0px #000000}
    span.s5 {font-kerning: none; color: #0000ff; background-color: #ecf1f7; -webkit-text-stroke: 0px #0000ff}
    span.s6 {font-kerning: none; color: #6b0001; background-color: #ecf1f7; -webkit-text-stroke: 0px #6b0001}
    span.s7 {font-kerning: none; color: #18702b; background-color: #ecf1f7; -webkit-text-stroke: 0px #18702b}
    span.s8 {font-kerning: none; color: #093c94; background-color: #ecf1f7; -webkit-text-stroke: 0px #093c94}
    span.s9 {font-kerning: none; color: #137646; background-color: #ecf1f7; -webkit-text-stroke: 0px #137646}
    span.s10 {font-kerning: none}
    span.s11 {font-kerning: none; color: #6f0ec3; background-color: #ecf1f7; -webkit-text-stroke: 0px #6f0ec3}
    span.s12 {font-kerning: none; color: #0e6e6d; background-color: #ecf1f7; -webkit-text-stroke: 0px #0e6e6d}
    span.s13 {font-kerning: none; color: #a4450b; background-color: #ecf1f7; -webkit-text-stroke: 0px #a4450b}
    span.s14 {font-kerning: none; color: #4d5055; background-color: #ecf1f7; -webkit-text-stroke: 0px #4d5055}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE</span><span class="s2"> html</span><span class="s1">&gt;</span></p>
<p class="p2"><span class="s3">&lt;</span><span class="s1">html</span><span class="s4"> </span><span class="s2">lang</span><span class="s3">=</span><span class="s5">"en"</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s3">&lt;</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s1">charset</span><span class="s3">=</span><span class="s5">"UTF-8"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"viewport"</span><span class="s4"> </span><span class="s2">content</span><span class="s3">=</span><span class="s1">"width=device-width, initial-scale=1.0"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">title</span><span class="s3">&gt;</span><span class="s1">MYP Teaching Resources</span><span class="s3">&lt;/</span><span class="s6">title</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Inter font from Google Fonts --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">link</span><span class="s4"> </span><span class="s2">rel</span><span class="s3">=</span><span class="s1">"preconnect"</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"https://fonts.googleapis.com"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">link</span><span class="s4"> </span><span class="s2">rel</span><span class="s3">=</span><span class="s1">"preconnect"</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"https://fonts.gstatic.com"</span><span class="s4"> </span><span class="s2">crossorigin</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">link</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;display=swap"</span><span class="s4"> </span><span class="s2">rel</span><span class="s3">=</span><span class="s1">"stylesheet"</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Tailwind CSS --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://cdn.tailwindcss.com"</span><span class="s3">&gt;&lt;/</span><span class="s6">script</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Google API Client Library --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://apis.google.com/js/api.js"</span><span class="s3">&gt;&lt;/</span><span class="s6">script</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Google Sign-In Library --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://accounts.google.com/gsi/client"</span><span class="s4"> </span><span class="s2">async</span><span class="s4"> </span><span class="s2">defer</span><span class="s3">&gt;&lt;/</span><span class="s6">script</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">body</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">font-family:</span><span class="s1"> </span><span class="s7">'Inter'</span><span class="s1">, </span><span class="s8">sans-serif</span><span class="s1">;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">background-color:</span><span class="s4"> </span><span class="s8">#f3f4f6</span><span class="s4">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">.container</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">max-width:</span><span class="s1"> </span><span class="s9">1200px</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.text-shadow-custom</span><span class="s4"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">text-shadow:</span><span class="s1"> </span><span class="s9">2px</span><span class="s1"> </span><span class="s9">2px</span><span class="s1"> </span><span class="s9">4px</span><span class="s1"> </span><span class="s8">rgba(</span><span class="s9">0</span><span class="s1">,</span><span class="s9">0</span><span class="s1">,</span><span class="s9">0</span><span class="s1">,</span><span class="s9">0.1</span><span class="s8">)</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s3">&lt;/</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s3">&lt;</span><span class="s6">body</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-gray-100 text-gray-800"</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Header --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">header</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-white shadow-sm sticky top-0 z-50"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"container mx-auto px-6 py-4 flex flex-col sm:flex-row justify-between items-center"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">h1</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-xl sm:text-2xl font-bold text-gray-900 text-center sm:text-left"</span><span class="s3">&gt;</span><span class="s4">MYP Teaching Resources</span><span class="s3">&lt;/</span><span class="s6">h1</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"auth-buttons"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"mt-4 sm:mt-0 flex space-x-2"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"authorize_button"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded-lg shadow-md transition-transform transform hover:scale-105 hidden"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>Sign In</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"signout_button"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-red-500 hover:bg-red-600 text-white font-medium py-2 px-4 rounded-lg shadow-md transition-transform transform hover:scale-105 hidden"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>Sign Out</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">header</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">main</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"container mx-auto px-4 py-8"</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;!-- Status and Welcome message --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"status"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-white p-6 rounded-lg shadow-md text-center hidden"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s1"> </span><span class="s2">id</span><span class="s3">=</span><span class="s5">"status-text"</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-lg font-medium text-gray-600"</span><span class="s3">&gt;</span><span class="s1">Please sign in to access your resources.</span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;!-- Resource Content --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"content"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"mt-8 grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-6 hidden"</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- Content will be dynamically injected here --&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;!-- Loading state --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"loading"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"mt-8 flex justify-center items-center flex-col hidden"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">svg</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"animate-spin h-12 w-12 text-blue-500"</span><span class="s4"> </span><span class="s2">xmlns</span><span class="s3">=</span><span class="s1">"http://www.w3.org/2000/svg"</span><span class="s4"> </span><span class="s2">fill</span><span class="s3">=</span><span class="s1">"none"</span><span class="s4"> </span><span class="s2">viewBox</span><span class="s3">=</span><span class="s1">"0 0 24 24"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">circle</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"opacity-25"</span><span class="s4"> </span><span class="s2">cx</span><span class="s3">=</span><span class="s1">"12"</span><span class="s4"> </span><span class="s2">cy</span><span class="s3">=</span><span class="s1">"12"</span><span class="s4"> </span><span class="s2">r</span><span class="s3">=</span><span class="s1">"10"</span><span class="s4"> </span><span class="s2">stroke</span><span class="s3">=</span><span class="s1">"currentColor"</span><span class="s4"> </span><span class="s2">stroke-width</span><span class="s3">=</span><span class="s1">"4"</span><span class="s3">&gt;&lt;/</span><span class="s6">circle</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">path</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"opacity-75"</span><span class="s4"> </span><span class="s2">fill</span><span class="s3">=</span><span class="s1">"currentColor"</span><span class="s4"> </span><span class="s2">d</span><span class="s3">=</span><span class="s1">"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"</span><span class="s3">&gt;&lt;/</span><span class="s6">path</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">svg</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"mt-4 text-gray-500"</span><span class="s3">&gt;</span><span class="s1">Loading your resources...</span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s6">main</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Use a self-invoking async function to handle the main logic</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>(</span><span class="s11">async</span><span class="s1"> () =&gt; {</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Check if API key is defined by the environment, otherwise use a placeholder</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> apiKey = </span><span class="s11">typeof</span><span class="s1"> __api_key__ !== </span><span class="s7">'undefined'</span><span class="s1"> ? __api_key__ : </span><span class="s7">''</span><span class="s1">;<span class="Apple-converted-space"> </span></span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Hardcoded client ID for your Google APIs project.</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Replace this with your own if you create a project.</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// NOTE: The Canvas environment provides a client ID automatically.</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s4"> gapiClientId = </span><span class="s11">typeof</span><span class="s4"> __gapi_client_id__ !== </span><span class="s1">'undefined'</span><span class="s4"> ? __gapi_client_id__ : </span><span class="s1">'473136284693-1b919n244f777174627b7d6v4324f8d2.apps.googleusercontent.com'</span><span class="s4">;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s4"> </span><span class="s12">DISCOVERY_DOCS</span><span class="s4"> = [</span><span class="s1">"https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"</span><span class="s4">];</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s4"> </span><span class="s12">SCOPES</span><span class="s4"> = </span><span class="s1">'https://www.googleapis.com/auth/drive.readonly'</span><span class="s4">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> </span><span class="s12">MYP_FOLDER_NAME</span><span class="s1"> = </span><span class="s7">'MYP'</span><span class="s1">;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> authorizeButton = document.getElementById(</span><span class="s7">'authorize_button'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> signoutButton = document.getElementById(</span><span class="s7">'signout_button'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> statusDiv = document.getElementById(</span><span class="s7">'status'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> statusText = document.getElementById(</span><span class="s7">'status-text'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> contentDiv = document.getElementById(</span><span class="s7">'content'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> loadingDiv = document.getElementById(</span><span class="s7">'loading'</span><span class="s1">);</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">let</span><span class="s1"> gapiLoaded = </span><span class="s11">false</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">let</span><span class="s1"> gapiClientInited = </span><span class="s11">false</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">let</span><span class="s1"> tokenClient = </span><span class="s11">null</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">let</span><span class="s1"> userAuthenticated = </span><span class="s11">false</span><span class="s1">;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Define file type icons and their colors for better visuals</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> fileIcons = {</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">'audio'</span><span class="s4">: </span><span class="s1">'&lt;svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-indigo-500" fill="currentColor" viewBox="0 0 24 24"&gt;&lt;path d="M12 3a9 9 0 00-9 9v1a1 1 0 001 1h.5a.5.5 0 00.5-.5V12a7 7 0 017-7h1a1 1 0 001-1V4a1 1 0 00-1-1zm-1 2a7 7 0 00-7 7v1a1 1 0 001 1h1a1 1 0 001-1v-1a5 5 0 015-5h1a1 1 0 001-1V6a1 1 0 00-1-1zm-1 3a5 5 0 00-5 5v1a1 1 0 001 1h1a1 1 0 001-1v-1a3 3 0 013-3h1a1 1 0 001-1V10a1 1 0 00-1-1zm-1 3a3 3 0 00-3 3v1a1 1 0 001 1h1a1 1 0 001-1v-1a1 1 0 011-1h1a1 1 0 001-1V14a1 1 0 00-1-1zm-1 2a1 1 0 00-1 1v1a1 1 0 001 1h1a1 1 0 001-1v-1a1 1 0 00-1-1z" /&gt;&lt;/svg&gt;'</span><span class="s4">,</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">'video'</span><span class="s4">: </span><span class="s1">'&lt;svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-red-500" fill="currentColor" viewBox="0 0 24 24"&gt;&lt;path d="M15 12c0 1.657-1.343 3-3 3s-3-1.343-3-3 1.343-3 3-3 3 1.343 3 3z"/&gt;&lt;path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12z"/&gt;&lt;/svg&gt;'</span><span class="s4">,</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">'doc'</span><span class="s4">: </span><span class="s1">'&lt;svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-blue-500" fill="currentColor" viewBox="0 0 24 24"&gt;&lt;path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6zm4 18H6V4h7v4h5v12z"/&gt;&lt;/svg&gt;'</span><span class="s4">,</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">'form'</span><span class="s4">: </span><span class="s1">'&lt;svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-purple-500" fill="currentColor" viewBox="0 0 24 24"&gt;&lt;path d="M16 2.012l-1.554 1.555a1.996 1.996 0 00-2.828 0L9.5 5.717l-3.328 3.328a2 2 0 000 2.828L12 18.012l5.828-5.828a2 2 0 000-2.828L16 2.012zm-3.172 13.828L8.172 10.844a2.986 2.986 0 01-1.32-.486L5.5 8.717l1.414-1.414 1.832 1.832 1.414-1.414L8.328 5.889 10.5 3.717 14.283 7.5l-2.828 2.828zm6.528-6.528L13.5 12.283l-2.828-2.828 6.028-6.028 2.828 2.828z"/&gt;&lt;/svg&gt;'</span><span class="s4">,</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">'folder'</span><span class="s4">: </span><span class="s1">'&lt;svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-yellow-500" fill="currentColor" viewBox="0 0 24 24"&gt;&lt;path d="M22 6h-8l-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2z"/&gt;&lt;/svg&gt;'</span><span class="s4">,</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">'default'</span><span class="s4">: </span><span class="s1">'&lt;svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-gray-500" fill="currentColor" viewBox="0 0 24 24"&gt;&lt;path d="M10 2a2 2 0 00-2 2v16a2 2 0 002 2h4a2 2 0 002-2V4a2 2 0 00-2-2h-4zM6 4a2 2 0 00-2 2v12a2 2 0 002 2h2V4H6zM18 4a2 2 0 00-2 2v12a2 2 0 002 2h2V4h-2z"/&gt;&lt;/svg&gt;'</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Recursively fetch all files and folders under a parent ID</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">async</span><span class="s1"> </span><span class="s11">function</span><span class="s1"> fetchAllChildren(parentId) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">let</span><span class="s1"> allFiles = [];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">let</span><span class="s1"> nextPageToken = </span><span class="s11">null</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">do</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">try</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s11">const</span><span class="s1"> response = </span><span class="s11">await</span><span class="s1"> gapi.client.drive.files.list({</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>q: </span><span class="s7">`'</span><span class="s1">${parentId}</span><span class="s7">' in parents`</span><span class="s1">,</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                            </span>fields: </span><span class="s1">'nextPageToken, files(id, name, mimeType, webViewLink, iconLink)'</span><span class="s4">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>pageToken: nextPageToken,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>pageSize: </span><span class="s13">1000</span><span class="s1"> </span><span class="s14">// Increase page size for efficiency</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>});</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>allFiles = allFiles.concat(response.result.files);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>nextPageToken = response.result.nextPageToken;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>} </span><span class="s11">catch</span><span class="s1"> (err) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>console.error(</span><span class="s7">'Error listing files:'</span><span class="s1">, err);</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                        </span>displayStatus(</span><span class="s1">'Error fetching files. Please try again.'</span><span class="s4">, </span><span class="s1">'text-red-500'</span><span class="s4">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s11">return</span><span class="s1"> [];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>} </span><span class="s11">while</span><span class="s1"> (nextPageToken);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">return</span><span class="s1"> allFiles;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Function to find a folder by name</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">async</span><span class="s1"> </span><span class="s11">function</span><span class="s1"> findFolderId(folderName) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">try</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">const</span><span class="s1"> response = </span><span class="s11">await</span><span class="s1"> gapi.client.drive.files.list({</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                        </span>q: </span><span class="s1">`name = '</span><span class="s4">${folderName}</span><span class="s1">' and mimeType = 'application/vnd.google-apps.folder' and trashed = false`</span><span class="s4">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>fields: </span><span class="s7">'files(id)'</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>});</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">const</span><span class="s1"> files = response.result.files;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">if</span><span class="s1"> (files &amp;&amp; files.length &gt; </span><span class="s13">0</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s11">return</span><span class="s1"> files[</span><span class="s13">0</span><span class="s1">].id;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>} </span><span class="s11">catch</span><span class="s1"> (err) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>console.error(</span><span class="s7">'Error finding folder:'</span><span class="s1">, err);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">return</span><span class="s1"> </span><span class="s11">null</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Function to organize and display resources</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">async</span><span class="s1"> </span><span class="s11">function</span><span class="s1"> listResources() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>showLoading(</span><span class="s11">true</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>contentDiv.innerHTML = </span><span class="s7">''</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">try</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">const</span><span class="s1"> mypFolderId = </span><span class="s11">await</span><span class="s1"> findFolderId(</span><span class="s12">MYP_FOLDER_NAME</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">if</span><span class="s1"> (!mypFolderId) {</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                        </span>displayStatus(</span><span class="s1">`The '</span><span class="s4">${</span><span class="s12">MYP_FOLDER_NAME</span><span class="s4">}</span><span class="s1">' folder was not found on your Google Drive. Please create it or check the name.`</span><span class="s4">, </span><span class="s1">'text-red-500'</span><span class="s4">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>showLoading(</span><span class="s11">false</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s11">return</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Get the theme folders inside MYP</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">const</span><span class="s1"> themeFolders = </span><span class="s11">await</span><span class="s1"> fetchAllChildren(mypFolderId);</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">const</span><span class="s1"> organizedData = {};</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">for</span><span class="s1"> (</span><span class="s11">const</span><span class="s1"> themeFolder </span><span class="s11">of</span><span class="s1"> themeFolders) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s11">if</span><span class="s1"> (themeFolder.mimeType === </span><span class="s7">'application/vnd.google-apps.folder'</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s11">const</span><span class="s1"> themeName = themeFolder.name;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>organizedData[themeName] = {};</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                            </span></span><span class="s1">// Get the task folders inside each theme folder</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s11">const</span><span class="s1"> taskFolders = </span><span class="s11">await</span><span class="s1"> fetchAllChildren(themeFolder.id);</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s11">for</span><span class="s1"> (</span><span class="s11">const</span><span class="s1"> taskFolder </span><span class="s11">of</span><span class="s1"> taskFolders) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s11">if</span><span class="s1"> (taskFolder.mimeType === </span><span class="s7">'application/vnd.google-apps.folder'</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s11">const</span><span class="s1"> taskName = taskFolder.name;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                                    </span></span><span class="s1">// Get the resources inside each task folder</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s11">const</span><span class="s1"> resources = </span><span class="s11">await</span><span class="s1"> fetchAllChildren(taskFolder.id);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                    </span>organizedData[themeName][taskName] = resources.filter(file =&gt; file.mimeType !== </span><span class="s7">'application/vnd.google-apps.folder'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>renderContent(organizedData);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>showLoading(</span><span class="s11">false</span><span class="s1">);</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>} </span><span class="s11">catch</span><span class="s1"> (err) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>console.error(</span><span class="s7">'Failed to list resources:'</span><span class="s1">, err);</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                    </span>displayStatus(</span><span class="s1">'Failed to load resources. Please check your connection and try again.'</span><span class="s4">, </span><span class="s1">'text-red-500'</span><span class="s4">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>showLoading(</span><span class="s11">false</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Helper function to render the UI from the organized data</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">function</span><span class="s1"> renderContent(data) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>contentDiv.classList.remove(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">for</span><span class="s1"> (</span><span class="s11">const</span><span class="s1"> theme </span><span class="s11">in</span><span class="s1"> data) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">const</span><span class="s1"> themeCard = document.createElement(</span><span class="s7">'div'</span><span class="s1">);</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                    </span>themeCard.className = </span><span class="s1">'col-span-1 md:col-span-3 lg:col-span-4 bg-white p-6 rounded-lg shadow-md'</span><span class="s4">;</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                    </span>themeCard.innerHTML = </span><span class="s1">`&lt;h2 class="text-2xl font-semibold mb-4 text-gray-800"&gt;</span><span class="s4">${theme}</span><span class="s1">&lt;/h2&gt;`</span><span class="s4">;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">for</span><span class="s1"> (</span><span class="s11">const</span><span class="s1"> task </span><span class="s11">in</span><span class="s1"> data[theme]) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s11">if</span><span class="s1"> (data[theme][task].length &gt; </span><span class="s13">0</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s11">const</span><span class="s1"> taskSection = document.createElement(</span><span class="s7">'div'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>taskSection.className = </span><span class="s7">'mb-6'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>taskSection.innerHTML = </span><span class="s7">`&lt;h3 class="text-xl font-medium text-gray-700 mb-2"&gt;</span><span class="s1">${task}</span><span class="s7">&lt;/h3&gt;`</span><span class="s1">;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s11">const</span><span class="s1"> resourcesList = document.createElement(</span><span class="s7">'div'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>resourcesList.className = </span><span class="s7">'space-y-3'</span><span class="s1">;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>data[theme][task].forEach(resource =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s11">const</span><span class="s1"> fileType = getFileType(resource.mimeType);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s11">const</span><span class="s1"> icon = fileIcons[fileType] || fileIcons.</span><span class="s11">default</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s11">const</span><span class="s1"> link = document.createElement(</span><span class="s7">'a'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                </span>link.href = resource.webViewLink;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                </span>link.target = </span><span class="s7">'_blank'</span><span class="s1">;</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                                </span>link.className = </span><span class="s1">'flex items-center space-x-3 p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors'</span><span class="s4">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                </span>link.innerHTML = </span><span class="s7">`</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;div class="flex-shrink-0"&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s4">${icon}</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;span class="text-gray-700 truncate font-normal"&gt;</span><span class="s4">${resource.name}</span><span class="s1">&lt;/span&gt;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                                </span>`</span><span class="s4">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                </span>resourcesList.appendChild(link);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>});</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>taskSection.appendChild(resourcesList);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>themeCard.appendChild(taskSection);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>contentDiv.appendChild(themeCard);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Get file type from mime type</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">function</span><span class="s1"> getFileType(mimeType) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">if</span><span class="s1"> (mimeType.includes(</span><span class="s7">'audio'</span><span class="s1">)) </span><span class="s11">return</span><span class="s1"> </span><span class="s7">'audio'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">if</span><span class="s1"> (mimeType.includes(</span><span class="s7">'video'</span><span class="s1">)) </span><span class="s11">return</span><span class="s1"> </span><span class="s7">'video'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">if</span><span class="s1"> (mimeType.includes(</span><span class="s7">'google-apps.document'</span><span class="s1">)) </span><span class="s11">return</span><span class="s1"> </span><span class="s7">'doc'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">if</span><span class="s1"> (mimeType.includes(</span><span class="s7">'google-apps.form'</span><span class="s1">)) </span><span class="s11">return</span><span class="s1"> </span><span class="s7">'form'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">return</span><span class="s1"> </span><span class="s7">'default'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Show or hide loading spinner</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">function</span><span class="s1"> showLoading(show) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">if</span><span class="s1"> (show) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>loadingDiv.classList.remove(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>statusDiv.classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>contentDiv.classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>} </span><span class="s11">else</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>loadingDiv.classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Display a status message</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">function</span><span class="s1"> displayStatus(message, className = </span><span class="s7">'text-gray-600'</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>statusDiv.classList.remove(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>statusText.textContent = message;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>statusText.className = </span><span class="s7">`text-lg font-medium </span><span class="s1">${className}</span><span class="s7">`</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>authorizeButton.classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>signoutButton.classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>contentDiv.classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Handles the authenticated state</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">function</span><span class="s1"> handleAuthStatus(isSignedIn) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">if</span><span class="s1"> (isSignedIn) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>authorizeButton.classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>signoutButton.classList.remove(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>statusDiv.classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>userAuthenticated = </span><span class="s11">true</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>listResources();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>} </span><span class="s11">else</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>authorizeButton.classList.remove(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>signoutButton.classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                    </span>displayStatus(</span><span class="s1">'Please sign in to access your resources.'</span><span class="s4">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>userAuthenticated = </span><span class="s11">false</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>contentDiv.classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Initial Gapi load and auth setup</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">async</span><span class="s1"> </span><span class="s11">function</span><span class="s1"> handleClientLoad() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">try</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">await</span><span class="s1"> gapi.client.init({</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>apiKey: apiKey,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>discoveryDocs: </span><span class="s12">DISCOVERY_DOCS</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>});</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>gapiClientInited = </span><span class="s11">true</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>tokenClient = google.accounts.oauth2.initTokenClient({</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>client_id: gapiClientId,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>scope: </span><span class="s12">SCOPES</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>callback: (resp) =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s11">if</span><span class="s1"> (resp.error !== </span><span class="s11">undefined</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s11">throw</span><span class="s1"> (resp);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>handleAuthStatus(</span><span class="s11">true</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>},</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>});</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Check if a token already exists and is valid</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">if</span><span class="s1"> (gapi.client.getToken() === </span><span class="s11">null</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>handleAuthStatus(</span><span class="s11">false</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>} </span><span class="s11">else</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>handleAuthStatus(</span><span class="s11">true</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>} </span><span class="s11">catch</span><span class="s1"> (err) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>console.error(</span><span class="s7">'Error initializing GAPI client:'</span><span class="s1">, err);</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                    </span>displayStatus(</span><span class="s1">'Failed to initialize. Please check your network.'</span><span class="s4">, </span><span class="s1">'text-red-500'</span><span class="s4">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Handles sign-in</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">function</span><span class="s1"> handleAuthClick() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">if</span><span class="s1"> (gapi.client.getToken() === </span><span class="s11">null</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>tokenClient.requestAccessToken({prompt: </span><span class="s7">'consent'</span><span class="s1">});</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>} </span><span class="s11">else</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>tokenClient.requestAccessToken({prompt: </span><span class="s7">''</span><span class="s1">});</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Handles sign-out</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">function</span><span class="s1"> handleSignoutClick() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> token = gapi.client.getToken();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">if</span><span class="s1"> (token !== </span><span class="s11">null</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>google.accounts.oauth2.revoke(token.access_token);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>gapi.client.setToken(</span><span class="s7">''</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>handleAuthStatus(</span><span class="s11">false</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Event listeners for buttons</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>authorizeButton.addEventListener(</span><span class="s7">'click'</span><span class="s1">, handleAuthClick);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>signoutButton.addEventListener(</span><span class="s7">'click'</span><span class="s1">, handleSignoutClick);</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Load Google API libraries</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">function</span><span class="s1"> gapiOnLoad() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>gapi.load(</span><span class="s7">'client'</span><span class="s1">, handleClientLoad);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// This function is required by Google's API to run when the script loads</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>window.gapiLoaded = gapiOnLoad;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Wait for window to load</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>window.onload = </span><span class="s11">function</span><span class="s1">() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>gapiOnLoad();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>})();</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s3">&lt;/</span><span class="s1">body</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s3">&lt;/</span><span class="s1">html</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s10"></span><br></p>
</body>
</html>
